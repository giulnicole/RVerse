---
title: "Rverse"
author: "PhD student Giulia Nicole Baldrighi"
date: "2024-03-20"
output:
  ioslides_presentation: default
  beamer_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


# Handling projects for reproducibility


# R projects


## Setting a new project

- New folder in an accessible place of laptop


- copy my repository (RVerse) to have the necessary material

- - go to the link on GitHub

- - download the material within the folder you will use for working 

- - create and save a project (snapshot) within your folder



File --> New project ...

- - - 

**File Type**

- **.Rproj**	This is your project file in RStudio. This automatically sets your working directory to this containing folder

- **.R**	This is your script file. It contains your previously saved code. Like a Word Document.

- **.RHistory**	R keeps track of all the commands you use in a session.




## Rproject

- Valuable and reproducible workflow that will serve in the future
 
- Import the data (Environment -> Import Dataset)
```{r, echo=FALSE}
data <- read.csv("C:/Users/gnbal/Desktop/GitHub/RVerse/data/Lars data.csv.gz")
```

- You can then save and leave everything as in a snapshot.

 
 
- - -

**Open/close the project** 

- Top right button (open/close)

- It is good practice to look at your pathway sometimes `getwd()`

- When you open your project you do not need to set the working directory (Session is already set)

```{r centering}
setwd("C:/Users/gnbal/Desktop/GitHub/RVerse/data")
```

 
 
- - -  
 
### **Good workflow** 

- Save your scripts (with informative names) in the project, edit them, run them in bits or as a whole. 

- Restart R frequently to make sure you’ve captured everything in your scripts.

- Only ever use relative paths, not absolute paths.

More information at: 

(https://r4ds.had.co.nz/workflow-projects.html)




# Let's practice




## Reading the data 

- **External data**: import dataset (text, csv, excel ...) with `read()`

- **Internal data**: import dataset (rda) with `data()`

- Otherwise objects are included in the libraries. 

- - -

Example of external:

```{r, include=T}
data <- read.csv("C:/Users/gnbal/Desktop/GitHub/RVerse/data/Lars data.csv.gz")
```

```{r}
head(data[1:10,1:5])
```


- - -

Example of internal:

```{r include=TRUE}
data("mtcars")
```


```{r}
head(data[1:10,1:5])
```

- - -

Reading directly from library

```{r include=T, warning=FALSE, message=FALSE}
library(dplyr)
library(tidyverse)
head(diamonds)
```

- - -

**R base managing**

- Saving object in the *environment*: dati <- obj

- as.data.frame(dati), as.list(dati), as.matrix(dati)

- **NB**: with data frames we can give names to rows (rownames(dati))

- visualize variables: colnames(dati)

- - -

**Data frames**

- df <- as.data.frame()

- access to a variable: df$variable

- see which s.u. have values of var1> 1: which(df$var1>1)

- select values of var1 > 1: df[which(df$var1> 1),]

- subset only the s.u. with var2> 20: df2<- df[df$var2>20,]



# Let's practice



## Tidyverse

- as_tibble(name)

- summarise data using: `group_by()`, `summarise()`, and `mutate()`

- reshape data between the wide and long formats: `pivot_wider()` and `pivot_longer()`

- `select()` columns and `arrange()` (sort) rows.

- other important ones: `filter()` and `count()`  

More information at: (https://argoshare.is.ed.ac.uk/healthyr_book/exercises.html)


- - -

**group_by()** 

```{r warning=FALSE, message=FALSE}
library(dplyr)
library(tidyverse)
```


```{r warning=FALSE, message=FALSE}
head( diamonds %>% 
  group_by(clarity) )

```

- - -

**Saving the df in an object**
```{r}
data<- diamonds %>% 
  group_by(clarity) 
```

```{r}
head(data)
```

- - -

**group_by() %>% summarise()**

```{r}

diamonds %>% 
  group_by(clarity) %>% 
  summarize(m = mean(price))

```

- - -

**Logical operators**

To use filtering effectively, you have to know how to select the observations
that you want using the comparison operators. R provides
the standard suite: >, >=, <, <=, != (not equal), and == (equal).




**filter()**

When you run that line of code, dplyr executes the filtering operation
and returns a new data frame. dplyr functions never modify
their inputs, so if you want to save the result, you’ll need to use the
assignment operator, <-:


- - - 

**filter()**

filter(variable, variable2 == 1)


jan1 <- filter(variable, month == 1, day == 1)

nov_dec <- filter(flights, month %in% c(11, 12))


filter(flights, !(arr_delay > 120 | dep_delay > 120))
 
filter(flights, arr_delay <= 120, dep_delay <= 120)


- - -

**count()**

flights %>%
count(year, month, day, flight) %>%
filter(n > 1)



**select()**

flights2 <- flights %>%
select(year:day, hour, origin, dest, tailnum, carrier)




## Working on *Lars data*

**Libraries**

library(tidyverse)

library(ggplot2)

library(nycflights13)

**How to access variable type, number of observations and variables?**


- type

- length


## Answer the following questions

1) How many different mice were profiled in the experiment?

2) How many observations per mouse? Was there an equal number of observations for each mouse?

3) Is there any missing data? How much? Is there a mouse with more missing data than other mice? Or a week, a day, a ZT time with more missing data?

4) Across how many weeks was the experiment performed?

5) What is the mean, SD, and range in glucose value across weeks and days between the two different groups of mice?



 

# Let's practice


